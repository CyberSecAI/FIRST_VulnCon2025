Kind: captions Language: en Hey everybody. Uh, so this is Hey everybody. Uh, so this is Hey everybody. Uh, so this is identifying malicious oss across identifying malicious oss across identifying malicious oss across ecosystems. So I've had a lot of fun ecosystems. So I've had a lot of fun ecosystems. So I've had a lot of fun attending lots of the different attending lots of the different attending lots of the different sessions, hearing about CRA, CVEes. Um, sessions, hearing about CRA, CVEes. Um, sessions, hearing about CRA, CVEes. Um, this is Vongcon. Uh, this is a little this is Vongcon. Uh, this is a little this is Vongcon. Uh, this is a little bait and switch. I'm going to talk about bait and switch. I'm going to talk about bait and switch. I'm going to talk about malware. I'm not going to talk about malware. I'm not going to talk about malware. I'm not going to talk about vulnerabilities at all. So welcome. vulnerabilities at all. So welcome. vulnerabilities at all. So welcome. Hopefully after day at at day three, Hopefully after day at at day three, Hopefully after day at at day three, you're all ready for a different topic. you're all ready for a different topic. you're all ready for a different topic. Here we are. So, uh, who am I? I'm on Here we are. So, uh, who am I? I'm on Here we are. So, uh, who am I? I'm on Microsoft's open source security team. Microsoft's open source security team. Microsoft's open source security team. Uh, I do lots of things there, but my Uh, I do lots of things there, but my Uh, I do lots of things there, but my primary focus is on finding, uh, primary focus is on finding, uh, primary focus is on finding, uh, malicious open source software across malicious open source software across malicious open source software across multiple platforms. So, your npms, your multiple platforms. So, your npms, your multiple platforms. So, your npms, your pipies, your nugets, uh, VS Marketplace, pipies, your nugets, uh, VS Marketplace, pipies, your nugets, uh, VS Marketplace, etc. Uh, prior to market, prior to etc. Uh, prior to market, prior to etc. Uh, prior to market, prior to Microsoft, I primarily worked in the Microsoft, I primarily worked in the Microsoft, I primarily worked in the application security space. uh spent a application security space. uh spent a application security space. uh spent a long time building is and RAS products long time building is and RAS products long time building is and RAS products for .NET and .NET framework for .NET and .NET framework for .NET and .NET framework applications. Uh that's completely applications. Uh that's completely applications. Uh that's completely different. Catch me, you know, afterward different. Catch me, you know, afterward different. Catch me, you know, afterward and we can talk about that. Um but this and we can talk about that. Um but this and we can talk about that. Um but this is about malware. So agenda for today, uh talk about OSS So agenda for today, uh talk about OSS So agenda for today, uh talk about OSS malware, why it's there, how to find it. malware, why it's there, how to find it. malware, why it's there, how to find it. I'm going to tell you about a research I'm going to tell you about a research I'm going to tell you about a research project that we're calling osimilation project that we're calling osimilation project that we're calling osimilation uh to find malware across ecosystems and uh to find malware across ecosystems and uh to find malware across ecosystems and then share a few results of what we then share a few results of what we then share a few results of what we found some trends found some trends found some trends etc. Uh so why etc. Uh so why etc. Uh so why malware? malware? malware? Uh OSS is widely used. Uh you know Uh OSS is widely used. Uh you know Uh OSS is widely used. Uh you know everybody I think in this conference has everybody I think in this conference has everybody I think in this conference has tried it out that 96 or 97% of code tried it out that 96 or 97% of code tried it out that 96 or 97% of code bases include OSS. Uh has a low barrier bases include OSS. Uh has a low barrier bases include OSS. Uh has a low barrier to entry. Most repositories allow anyone to entry. Most repositories allow anyone to entry. Most repositories allow anyone with an email to publish packages at no with an email to publish packages at no with an email to publish packages at no cost to the publisher. cost to the publisher. cost to the publisher. There's lots of places to hide across 11 There's lots of places to hide across 11 There's lots of places to hide across 11 million individual OSS packages across million individual OSS packages across million individual OSS packages across many different platforms and many of many different platforms and many of many different platforms and many of those packages and have many versions those packages and have many versions those packages and have many versions and then you know as Michael Windsor and then you know as Michael Windsor and then you know as Michael Windsor pointed out in his earlier talk it these pointed out in his earlier talk it these pointed out in his earlier talk it these packages have access to your build packages have access to your build packages have access to your build systems they have access to your systems they have access to your systems they have access to your production systems all the valuable production systems all the valuable production systems all the valuable assets. assets. assets. So we're also seeing uh the number of So we're also seeing uh the number of So we're also seeing uh the number of malicious packages increasing year malicious packages increasing year malicious packages increasing year overyear. OSS is growing, malware and overyear. OSS is growing, malware and overyear. OSS is growing, malware and OSS is growing right alongside of it. And since it. And since it. And since uh we're also seeing uh we're also seeing uh we're also seeing uh malware in different repositories, uh malware in different repositories, uh malware in different repositories, uh npm is the the biggest here. Um but uh npm is the the biggest here. Um but uh npm is the the biggest here. Um but we're also seeing a you know large we're also seeing a you know large we're also seeing a you know large number in Pi and a number of the other number in Pi and a number of the other number in Pi and a number of the other repositories. These numbers of course repositories. These numbers of course repositories. These numbers of course from uh OSS OSSF's malicious package uh from uh OSS OSSF's malicious package uh from uh OSS OSSF's malicious package uh data data data set. So uh into sort of more the the set. So uh into sort of more the the set. So uh into sort of more the the meat of the presentation now that we meat of the presentation now that we meat of the presentation now that we understands the context of the problem. understands the context of the problem. understands the context of the problem. How do we find malware? Well, there's How do we find malware? Well, there's How do we find malware? Well, there's two traditional approaches. we can try two traditional approaches. we can try two traditional approaches. we can try and predict what the code will do with and predict what the code will do with and predict what the code will do with static analysis you know use compiler-l static analysis you know use compiler-l static analysis you know use compiler-l like techniques build our as build our like techniques build our as build our like techniques build our as build our call graphs and that's you know that call graphs and that's you know that call graphs and that's you know that that works um but it can be that works um but it can be that works um but it can be computationally expensive and there's a computationally expensive and there's a computationally expensive and there's a lot of open source out there to apply lot of open source out there to apply lot of open source out there to apply this to and then dynamic analysis we can this to and then dynamic analysis we can this to and then dynamic analysis we can observe what the code did run it observe what the code did run it observe what the code did run it hopefully in a sandbox you know take hopefully in a sandbox you know take hopefully in a sandbox you know take logs in lots of different logs in lots of different logs in lots of different ways but that's also uh can be difficult ways but that's also uh can be difficult ways but that's also uh can be difficult to scale to scale to scale uh catches most types of malware but not uh catches most types of malware but not uh catches most types of malware but not all and generally requires humans to all and generally requires humans to all and generally requires humans to review the results. The there's can be a review the results. The there's can be a review the results. The there's can be a large number of false positives uh large number of false positives uh large number of false positives uh generated by these tools, these generated by these tools, these generated by these tools, these approaches. approaches. approaches. So what if we wanted to find malware So what if we wanted to find malware So what if we wanted to find malware across multiple package managers? Static across multiple package managers? Static across multiple package managers? Static analysis, dynamic analysis and they're analysis, dynamic analysis and they're analysis, dynamic analysis and they're great, super powerful, but they're great, super powerful, but they're great, super powerful, but they're generally targeted towards a small generally targeted towards a small generally targeted towards a small number of languages. number of languages. number of languages. So what if we looked at the metadata for So what if we looked at the metadata for So what if we looked at the metadata for the different oss packages uh look at the different oss packages uh look at the different oss packages uh look at the information about the package the the information about the package the the information about the package the authors so what do I mean when I say authors so what do I mean when I say authors so what do I mean when I say metadata so here's an example from npm metadata so here's an example from npm metadata so here's an example from npm there's a huge amount of text a lot of there's a huge amount of text a lot of there's a huge amount of text a lot of you are sitting far back in the room I you are sitting far back in the room I you are sitting far back in the room I know you have no chance of reading this know you have no chance of reading this know you have no chance of reading this but it's generally things like the name but it's generally things like the name but it's generally things like the name the keywords for the package package, the keywords for the package package, the keywords for the package package, its description, what version it has. Uh its description, what version it has. Uh its description, what version it has. Uh this is a uh more popular package. I this is a uh more popular package. I this is a uh more popular package. I believe this is a what express that I believe this is a what express that I believe this is a what express that I pulled in here. And uh so there's also a pulled in here. And uh so there's also a pulled in here. And uh so there's also a lot of you know security information in lot of you know security information in lot of you know security information in here. So what might be interesting for here. So what might be interesting for here. So what might be interesting for us if we're looking to identify us if we're looking to identify us if we're looking to identify malware? Um lots of these fields are malware? Um lots of these fields are malware? Um lots of these fields are interesting for us if we want to try and interesting for us if we want to try and interesting for us if we want to try and identify malware. So, I I threw some red identify malware. So, I I threw some red identify malware. So, I I threw some red boxes in here. We're not going to dive boxes in here. We're not going to dive boxes in here. We're not going to dive into details here. Um, we're going to into details here. Um, we're going to into details here. Um, we're going to make this a slightly interactive make this a slightly interactive make this a slightly interactive session. Um, I don't know how hard how session. Um, I don't know how hard how session. Um, I don't know how hard how strict we want to be on the mics here, strict we want to be on the mics here, strict we want to be on the mics here, but we're going to play a little game. but we're going to play a little game. but we're going to play a little game. I'm going to give you some metadata for I'm going to give you some metadata for I'm going to give you some metadata for a package, and I'm going to ask someone a package, and I'm going to ask someone a package, and I'm going to ask someone to volunteer to tell me whether or not to volunteer to tell me whether or not to volunteer to tell me whether or not they believe it is malware or they believe it is malware or they believe it is malware or not. So, here's our first one. So fun package called crash handler. Yeah. All right. Why do you believe it's malware? No information whatsoever. They malware? No information whatsoever. They malware? No information whatsoever. They just left all the fields blank. One version, very high version. blank. One version, very high version. blank. One version, very high version. All right, you guys are going to be All right, you guys are going to be All right, you guys are going to be great at this game. All right. So, yes, this is actually a All right. So, yes, this is actually a All right. So, yes, this is actually a it's a namespace confusion. So, there is it's a namespace confusion. So, there is it's a namespace confusion. So, there is a well-known npm package called crash a well-known npm package called crash a well-known npm package called crash handler, but it's incom reliability kit handler, but it's incom reliability kit handler, but it's incom reliability kit namespace. And so, this attacker just namespace. And so, this attacker just namespace. And so, this attacker just said, you know what, I I can publish said, you know what, I I can publish said, you know what, I I can publish that package just without the namespace. that package just without the namespace. that package just without the namespace. And if you're a developer pulling in And if you're a developer pulling in And if you're a developer pulling in this package, you might not pay super this package, you might not pay super this package, you might not pay super close attention. You might accidentally close attention. You might accidentally close attention. You might accidentally pull in malware. But yeah, one version, pull in malware. But yeah, one version, pull in malware. But yeah, one version, high version, super suspicious. But npm high version, super suspicious. But npm high version, super suspicious. But npm also offers this opportunity to run also offers this opportunity to run also offers this opportunity to run scripts when you install the package. scripts when you install the package. scripts when you install the package. And so attackers love this And so attackers love this And so attackers love this capability. All right, onto our second capability. All right, onto our second capability. All right, onto our second example. Fun package called PDF password example. Fun package called PDF password example. Fun package called PDF password protector util. All right. Over here on the right, util. All right. Over here on the right, util. All right. Over here on the right, why is it malware? why is it malware? why is it malware? All right. So, it runs a Maven All right. So, it runs a Maven All right. So, it runs a Maven command. That's super suspicious. As command. That's super suspicious. As command. That's super suspicious. As soon as you install it, it runs Maven soon as you install it, it runs Maven soon as you install it, it runs Maven clean package. package. package. Yeah. Yeah. Yeah. Okay. Yeah. So, the the the repo and the Okay. Yeah. So, the the the repo and the Okay. Yeah. So, the the the repo and the package name don't match. This is package name don't match. This is package name don't match. This is suspicious. We should probably take suspicious. We should probably take suspicious. We should probably take another look. Uh, we threw some tools. another look. Uh, we threw some tools. another look. Uh, we threw some tools. We used our human eyeballs. We reviewed We used our human eyeballs. We reviewed We used our human eyeballs. We reviewed the code in this package. It's not the code in this package. It's not the code in this package. It's not malware. It does suspicious malware. It does suspicious malware. It does suspicious things, but it's not things, but it's not things, but it's not malware. So, it actually like calls out malware. So, it actually like calls out malware. So, it actually like calls out to a JAR file to encrypt passwords, and to a JAR file to encrypt passwords, and to a JAR file to encrypt passwords, and it's it was odd, but, you know, benign. Uh the the metadata for this one benign. Uh the the metadata for this one benign. Uh the the metadata for this one I believe came from libraries I io which I believe came from libraries I io which I believe came from libraries I io which we're going to discuss in a second. I've we're going to discuss in a second. I've we're going to discuss in a second. I've got three more rounds of this game to got three more rounds of this game to got three more rounds of this game to play and uh we're going to get through play and uh we're going to get through play and uh we're going to get through that and then we're going to talk get that and then we're going to talk get that and then we're going to talk get back to the you know the uh academic back to the you know the uh academic back to the you know the uh academic content. All right. content. All right. content. All right. So we're going to call this agent base. So we're going to call this agent base. So we're going to call this agent base. Is it Is it Is it malware? All right. Resounding yes. Why versions aren't lining up? Yeah, one Why versions aren't lining up? Yeah, one Why versions aren't lining up? Yeah, one version version version 7.11. It does some post install 7.11. It does some post install 7.11. It does some post install nonsense. Yeah, you guys are good. This nonsense. Yeah, you guys are good. This nonsense. Yeah, you guys are good. This one's one's one's malware. Uh, so this was actually typo malware. Uh, so this was actually typo malware. Uh, so this was actually typo squatting on the real agent base squatting on the real agent base squatting on the real agent base package. They just left out the A. Easy package. They just left out the A. Easy package. They just left out the A. Easy mistake to make. Um, and this was mistake to make. Um, and this was mistake to make. Um, and this was actually part of a larger malware actually part of a larger malware actually part of a larger malware campaign. And so I think there were a campaign. And so I think there were a campaign. And so I think there were a couple dozen packages published uh that couple dozen packages published uh that couple dozen packages published uh that all had the same technique. All right. HTB test- CLI. We're all thinking very carefully. All right. All right. All right. So, I like that we're not sure because So, I like that we're not sure because So, I like that we're not sure because this one's not malware. They're running this one's not malware. They're running this one's not malware. They're running R. They package it up R. They package it up R. They package it up Rust and then are distributing it via Rust and then are distributing it via Rust and then are distributing it via npm. Weird. But it's not malware. And uh just Weird. But it's not malware. And uh just Weird. But it's not malware. And uh just for those playing along at home, the for those playing along at home, the for those playing along at home, the ones that aren't malware, they have been ones that aren't malware, they have been ones that aren't malware, they have been anonymized, you know, shifted ever so anonymized, you know, shifted ever so anonymized, you know, shifted ever so slightly from the real packages. slightly from the real packages. slightly from the real packages. But how about this guy the last round? But how about this guy the last round? But how about this guy the last round? This package. Oh man, we're we are so This package. Oh man, we're we are so This package. Oh man, we're we are so confident this one's malware. confident this one's malware. confident this one's malware. Why? Yeah, it's typo squatting. They Why? Yeah, it's typo squatting. They Why? Yeah, it's typo squatting. They didn't even change the description. didn't even change the description. didn't even change the description. They left the description spelled They left the description spelled They left the description spelled correctly but messed up the name. So correctly but messed up the name. So correctly but messed up the name. So yeah, the last one's a little bit of a yeah, the last one's a little bit of a yeah, the last one's a little bit of a gimme. They're they're typo squatting on gimme. They're they're typo squatting on gimme. They're they're typo squatting on prettier. Pretty popular prettier. Pretty popular prettier. Pretty popular package. They have the same repo URL. package. They have the same repo URL. package. They have the same repo URL. That's what clued us into this package. That's what clued us into this package. That's what clued us into this package. Um so yeah, and they just this one's Um so yeah, and they just this one's Um so yeah, and they just this one's also funny because a lot of anti virus also funny because a lot of anti virus also funny because a lot of anti virus would actually catch this because they would actually catch this because they would actually catch this because they included the malware as a bundled binary included the malware as a bundled binary included the malware as a bundled binary in the in the npm package. So, as soon in the in the npm package. So, as soon in the in the npm package. So, as soon as you download it, your anti virus as you download it, your anti virus as you download it, your anti virus should yell at it if it's any good. All should yell at it if it's any good. All should yell at it if it's any good. All right. So, right. So, right. So, uh, what if we wanted to look at the uh, what if we wanted to look at the uh, what if we wanted to look at the metadata for multiple package managers? metadata for multiple package managers? metadata for multiple package managers? This was a fun little game. We looked at This was a fun little game. We looked at This was a fun little game. We looked at just five packages from npm. They all just five packages from npm. They all just five packages from npm. They all did some funny things. Um, and we could did some funny things. Um, and we could did some funny things. Um, and we could certainly just scrape npm and pi and do certainly just scrape npm and pi and do certainly just scrape npm and pi and do this ourselves, but luckily other people this ourselves, but luckily other people this ourselves, but luckily other people have already done this for us. Um, so have already done this for us. Um, so have already done this for us. Um, so there's libraries.io, ecosystems, and there's libraries.io, ecosystems, and there's libraries.io, ecosystems, and deps.dev all provide sort of a uh deps.dev all provide sort of a uh deps.dev all provide sort of a uh neutral metadata format for multiple neutral metadata format for multiple neutral metadata format for multiple package managers. They all go out and package managers. They all go out and package managers. They all go out and scrape these uh package managers scrape these uh package managers scrape these uh package managers themselves. Um, and this leads us into themselves. Um, and this leads us into themselves. Um, and this leads us into the uh research project uh that I the uh research project uh that I the uh research project uh that I promised I would talk about. So uh we promised I would talk about. So uh we promised I would talk about. So uh we chose to use uh libraries.io. they've chose to use uh libraries.io. they've chose to use uh libraries.io. they've got a useful API that lets us grab the got a useful API that lets us grab the got a useful API that lets us grab the most recently published packages. So, we most recently published packages. So, we most recently published packages. So, we do that on a regular interval. We pull do that on a regular interval. We pull do that on a regular interval. We pull it. Then, we reach out to specific it. Then, we reach out to specific it. Then, we reach out to specific registries to get any metadata that registries to get any metadata that registries to get any metadata that might be interesting that isn't included might be interesting that isn't included might be interesting that isn't included in the neutral format. For example, like in the neutral format. For example, like in the neutral format. For example, like npm's install scripts. They're pretty npm's install scripts. They're pretty npm's install scripts. They're pretty interesting. That's how a lot of npm interesting. That's how a lot of npm interesting. That's how a lot of npm malware abuses them. So, we want to make malware abuses them. So, we want to make malware abuses them. So, we want to make sure we grab that metadata as well. We sure we grab that metadata as well. We sure we grab that metadata as well. We log all that and then we run some rules log all that and then we run some rules log all that and then we run some rules against those logs and get alerts for us against those logs and get alerts for us against those logs and get alerts for us to then manually inspect and run tools to then manually inspect and run tools to then manually inspect and run tools to find to find to find malware. Uh, as you saw in our little malware. Uh, as you saw in our little malware. Uh, as you saw in our little game, we can't just trust just the game, we can't just trust just the game, we can't just trust just the metadata to accurately identify our metadata to accurately identify our metadata to accurately identify our malware. We generally always need a malware. We generally always need a malware. We generally always need a human in the loop to uh accurately human in the loop to uh accurately human in the loop to uh accurately identify. Uh we have lots of ideas and identify. Uh we have lots of ideas and identify. Uh we have lots of ideas and plans for this system. We want to plans for this system. We want to plans for this system. We want to integrate with other tools. I actually integrate with other tools. I actually integrate with other tools. I actually just got a uh you know specific internal just got a uh you know specific internal just got a uh you know specific internal tool integrated to this process. Um I tool integrated to this process. Um I tool integrated to this process. Um I found some more malware and you know found some more malware and you know found some more malware and you know maybe at next year's Vcon I'll tell you maybe at next year's Vcon I'll tell you maybe at next year's Vcon I'll tell you about that but that's ongoing work. about that but that's ongoing work. about that but that's ongoing work. Um the main flow today is right here. Um the main flow today is right here. Um the main flow today is right here. Um, Um, Um, so let's talk about some of the results so let's talk about some of the results so let's talk about some of the results that we've Oh, yes. Go ahead. That is a great question. So, ahead. That is a great question. So, ahead. That is a great question. So, right now we report them to the owners right now we report them to the owners right now we report them to the owners of the package managers and so they of the package managers and so they of the package managers and so they generally take them down. So if we went generally take them down. So if we went generally take them down. So if we went back in time here and you know we you back in time here and you know we you back in time here and you know we you went and tried to find went and tried to find went and tried to find partier it will uh tell you this is not partier it will uh tell you this is not partier it will uh tell you this is not found. Oh no you get a security holding found. Oh no you get a security holding found. Oh no you get a security holding package message for this npm package message for this npm package message for this npm package. package. package. Um yeah we're Um yeah we're Um yeah we're uh we're open to innovation on you know uh we're open to innovation on you know uh we're open to innovation on you know faster ways to uh but generally getting faster ways to uh but generally getting faster ways to uh but generally getting it removed from the package manager I it removed from the package manager I it removed from the package manager I think is you know been good enough to think is you know been good enough to think is you know been good enough to date. date. date. Um back to Um back to Um back to uh let's talk about the results for what uh let's talk about the results for what uh let's talk about the results for what we've found so far. Um so we pretty we've found so far. Um so we pretty we've found so far. Um so we pretty frequently find packages that are trying frequently find packages that are trying frequently find packages that are trying to excfiltrate either benign or to excfiltrate either benign or to excfiltrate either benign or sensitive data from the local system and sensitive data from the local system and sensitive data from the local system and lots of packages that connect to remote lots of packages that connect to remote lots of packages that connect to remote systems, download some script and try to systems, download some script and try to systems, download some script and try to run it. Um a bit of crypto steelers, run it. Um a bit of crypto steelers, run it. Um a bit of crypto steelers, miners and binaries and lots and lots of miners and binaries and lots and lots of miners and binaries and lots and lots of spam packages. Uh so I'm going to spam packages. Uh so I'm going to spam packages. Uh so I'm going to primarily talk about the exfiltators, primarily talk about the exfiltators, primarily talk about the exfiltators, droppers, and the spam droppers, and the spam droppers, and the spam packages. So back to our friend crash packages. So back to our friend crash packages. So back to our friend crash handler. Uh so this is just a snippet of handler. Uh so this is just a snippet of handler. Uh so this is just a snippet of the code uh from this guy. So it connect the code uh from this guy. So it connect the code uh from this guy. So it connect it collects information about your home it collects information about your home it collects information about your home system, your DNS, your system, your DNS, your system, your DNS, your IP, and then sends it off to uh with IP, and then sends it off to uh with IP, and then sends it off to uh with some Discord web hook, you know. So some some Discord web hook, you know. So some some Discord web hook, you know. So some bad guy's just monitoring his Discord bad guy's just monitoring his Discord bad guy's just monitoring his Discord channel watching machines report in that channel watching machines report in that channel watching machines report in that have installed this package. Um we've have installed this package. Um we've have installed this package. Um we've also seen packages that try to collect also seen packages that try to collect also seen packages that try to collect browser passwords, other sensitive data browser passwords, other sensitive data browser passwords, other sensitive data from the local from the local from the local system. Our friend agent base. Uh so system. Our friend agent base. Uh so system. Our friend agent base. Uh so here's the code. This is pretty typical here's the code. This is pretty typical here's the code. This is pretty typical of the code that we'll see in this of the code that we'll see in this of the code that we'll see in this malware style packages. Uh they ran it malware style packages. Uh they ran it malware style packages. Uh they ran it through an obuscator. We've got, you through an obuscator. We've got, you through an obuscator. We've got, you know, not a ton of ideas of what to do know, not a ton of ideas of what to do know, not a ton of ideas of what to do uh here because it's also very common to uh here because it's also very common to uh here because it's also very common to ship minified and obuscated code in just ship minified and obuscated code in just ship minified and obuscated code in just legitimate packages. Luckily, you know, legitimate packages. Luckily, you know, legitimate packages. Luckily, you know, good security people the ecosystem have good security people the ecosystem have good security people the ecosystem have wrote a number of deobuscators so you wrote a number of deobuscators so you wrote a number of deobuscators so you can get to reasonably readable code. Uh can get to reasonably readable code. Uh can get to reasonably readable code. Uh so this is a snippet of the de so this is a snippet of the de so this is a snippet of the de obfuscated code and it connects to a obfuscated code and it connects to a obfuscated code and it connects to a uh Ethereum wallet to get a IP address uh Ethereum wallet to get a IP address uh Ethereum wallet to get a IP address downloads a script and then executes the downloads a script and then executes the downloads a script and then executes the script and then there's some there was script and then there's some there was script and then there's some there was some uh intelligence in the obuscated some uh intelligence in the obuscated some uh intelligence in the obuscated code based on operating system but uh I code based on operating system but uh I code based on operating system but uh I just kept the the Windows bits in here. just kept the the Windows bits in here. just kept the the Windows bits in here. Um, all right. So, let's let's talk Um, all right. So, let's let's talk Um, all right. So, let's let's talk about some of the spam campaigns that about some of the spam campaigns that about some of the spam campaigns that we've seen here. Uh, so we had one of a we've seen here. Uh, so we had one of a we've seen here. Uh, so we had one of a a number of packages come across our a number of packages come across our a number of packages come across our desk like this. Um, npm helpfully has desk like this. Um, npm helpfully has desk like this. Um, npm helpfully has this capability to display your readme this capability to display your readme this capability to display your readme as if it's a web as if it's a web as if it's a web page. And so, bad guys said, great, I'd page. And so, bad guys said, great, I'd page. And so, bad guys said, great, I'd like to use your ability to display web like to use your ability to display web like to use your ability to display web pages for free. pages for free. pages for free. And when you clicked on a link in that And when you clicked on a link in that And when you clicked on a link in that web page, it took you to uh some web page, it took you to uh some web page, it took you to uh some advertising referral link loop. So advertising referral link loop. So advertising referral link loop. So anytime a victim would click on one of anytime a victim would click on one of anytime a victim would click on one of these, they'd get taken to another these, they'd get taken to another these, they'd get taken to another advertisement and another advertisement advertisement and another advertisement advertisement and another advertisement and so on and so on. And presumably, you and so on and so on. And presumably, you and so on and so on. And presumably, you know, bad guys are making fractions of a know, bad guys are making fractions of a know, bad guys are making fractions of a penny, but they're making fractions of a penny, but they're making fractions of a penny, but they're making fractions of a penny for free. So they're very happy to penny for free. So they're very happy to penny for free. So they're very happy to just upload garbage packages. Um we were just upload garbage packages. Um we were just upload garbage packages. Um we were not the first to observe this. um it's not the first to observe this. um it's not the first to observe this. um it's not new or novel. There have been news not new or novel. There have been news not new or novel. There have been news articles. Most of the packages were articles. Most of the packages were articles. Most of the packages were published in two published in two published in two 2023. Um this doesn't seem to be 2023. Um this doesn't seem to be 2023. Um this doesn't seem to be ongoing. Um and this is not necessarily ongoing. Um and this is not necessarily ongoing. Um and this is not necessarily traditional malware, but it's traditional malware, but it's traditional malware, but it's definitely it's spam. It erodess trust definitely it's spam. It erodess trust definitely it's spam. It erodess trust in the ecosystem. And you know, package in the ecosystem. And you know, package in the ecosystem. And you know, package managers don't want to host this stuff managers don't want to host this stuff managers don't want to host this stuff for free. So, we're happy to report it for free. So, we're happy to report it for free. So, we're happy to report it and get it and get it and get it removed. Uh yes, question. So the question was, do we see this as a So the question was, do we see this as a So the question was, do we see this as a targeted attack or just a broad fishing targeted attack or just a broad fishing targeted attack or just a broad fishing let's see who falls for it uh attack? I let's see who falls for it uh attack? I let's see who falls for it uh attack? I would say it's more the latter because would say it's more the latter because would say it's more the latter because these name the names on these packages these name the names on these packages these name the names on these packages are literally just like hey here's a are literally just like hey here's a are literally just like hey here's a popular popular popular ebook. Come click on this link to get ebook. Come click on this link to get ebook. Come click on this link to get the ebook for free. Um I don't think the ebook for free. Um I don't think the ebook for free. Um I don't think they're trying to look like software. they're trying to look like software. they're trying to look like software. They're just trying to host free web They're just trying to host free web They're just trying to host free web pages. Follow-up question. Yeah. So, uh just to repeat question. Yeah. So, uh just to repeat question. Yeah. So, uh just to repeat for people on on the mic, uh audience for people on on the mic, uh audience for people on on the mic, uh audience member here is their organization is member here is their organization is member here is their organization is seeing spam packages, typo squats for seeing spam packages, typo squats for seeing spam packages, typo squats for packages that you use. Um but they've packages that you use. Um but they've packages that you use. Um but they've largely already been taken down. So, largely already been taken down. So, largely already been taken down. So, um I will say that I can't speak to um I will say that I can't speak to um I will say that I can't speak to whether or not the folks maintaining npm whether or not the folks maintaining npm whether or not the folks maintaining npm see that. Um we collaborate with the folks at npm, Um we collaborate with the folks at npm, Um we collaborate with the folks at npm, but this is more of a independent effort but this is more of a independent effort but this is more of a independent effort to find malware across the ecosystems. to find malware across the ecosystems. to find malware across the ecosystems. But I'd be happy to uh you know talk to But I'd be happy to uh you know talk to But I'd be happy to uh you know talk to the folks at npm and see what kind of the folks at npm and see what kind of the folks at npm and see what kind of you know telemetry observability they you know telemetry observability they you know telemetry observability they have into uh malicious packages have into uh malicious packages have into uh malicious packages targeting specific organizations. targeting specific organizations. targeting specific organizations. Um, I know that we I've got about eight Um, I know that we I've got about eight Um, I know that we I've got about eight minutes left and I want to make sure we minutes left and I want to make sure we minutes left and I want to make sure we get through the the last part of this uh get through the the last part of this uh get through the the last part of this uh spam packages and then we'll wrap up and spam packages and then we'll wrap up and spam packages and then we'll wrap up and then I'm happy to take more questions. then I'm happy to take more questions. then I'm happy to take more questions. So So So uh as we mentioned earlier uh we have a uh as we mentioned earlier uh we have a uh as we mentioned earlier uh we have a number of alerts that look at the log number of alerts that look at the log number of alerts that look at the log data data data and you know I as mentioned earlier from and you know I as mentioned earlier from and you know I as mentioned earlier from Microsoft we have some rules that look Microsoft we have some rules that look Microsoft we have some rules that look for packages that might be trying to for packages that might be trying to for packages that might be trying to impersonate Microsoft. One of our, you impersonate Microsoft. One of our, you impersonate Microsoft. One of our, you know, special words is Azure. And this know, special words is Azure. And this know, special words is Azure. And this package contained the word Azure married package contained the word Azure married package contained the word Azure married Azured Swan. But you can imagine the Azured Swan. But you can imagine the Azured Swan. But you can imagine the random name generator that created this. random name generator that created this. random name generator that created this. And so it came across our desk. We And so it came across our desk. We And so it came across our desk. We looked at it and said, "This has a lot looked at it and said, "This has a lot looked at it and said, "This has a lot of dependencies and we don't recognize of dependencies and we don't recognize of dependencies and we don't recognize any of them." any of them." any of them." So, we dug into one of these packages So, we dug into one of these packages So, we dug into one of these packages and it's uh dsaturn gaul 45 and it has and it's uh dsaturn gaul 45 and it has and it's uh dsaturn gaul 45 and it has 42,000 dependent 42,000 dependent 42,000 dependent projects. That's not reasonable. Um it projects. That's not reasonable. Um it projects. That's not reasonable. Um it also contains this uh t.yml also contains this uh t.yml also contains this uh t.yml file. So, we went and learned what a t.l file. So, we went and learned what a t.l file. So, we went and learned what a t.l file was and it is part of this t file was and it is part of this t file was and it is part of this t protocol. protocol. protocol. uh open source sustainability is a real uh open source sustainability is a real uh open source sustainability is a real problem and we totally appreciate the problem and we totally appreciate the problem and we totally appreciate the efforts folks are spending trying to efforts folks are spending trying to efforts folks are spending trying to address that problem. uh the T protocol address that problem. uh the T protocol address that problem. uh the T protocol is one effort in that area and so they is one effort in that area and so they is one effort in that area and so they propose we'll make crypto payments to propose we'll make crypto payments to propose we'll make crypto payments to people based on their T- rank and their people based on their T- rank and their people based on their T- rank and their T- rank is largely based on the number T- rank is largely based on the number T- rank is largely based on the number of dependents for that project and so we of dependents for that project and so we of dependents for that project and so we just invited bad guys to make fake just invited bad guys to make fake just invited bad guys to make fake projects and make tens of thousands of projects and make tens of thousands of projects and make tens of thousands of dependencies on them. Uh so these are dependencies on them. Uh so these are dependencies on them. Uh so these are screenshots from the T protocols screenshots from the T protocols screenshots from the T protocols website. Um you can see at the top up website. Um you can see at the top up website. Um you can see at the top up here uh next and bus boy you know like here uh next and bus boy you know like here uh next and bus boy you know like reasonably popular packages. Um leftpad reasonably popular packages. Um leftpad reasonably popular packages. Um leftpad is up here. We remember a few you know is up here. We remember a few you know is up here. We remember a few you know issues about leftpad in recent memory. issues about leftpad in recent memory. issues about leftpad in recent memory. And then our friend desire gall 45. It's And then our friend desire gall 45. It's And then our friend desire gall 45. It's ranked low, but it's ranked low, but it's ranked low, but it's ranked and you know, so presumably ranked and you know, so presumably ranked and you know, so presumably they're receiving some sort of payment they're receiving some sort of payment they're receiving some sort of payment from the T protocol. So again, not traditional protocol. So again, not traditional protocol. So again, not traditional malware platform spam and abuse. Uh we malware platform spam and abuse. Uh we malware platform spam and abuse. Uh we worked with uh npm to get 47,000 plus worked with uh npm to get 47,000 plus worked with uh npm to get 47,000 plus packages removed. packages removed. packages removed. Um this was not again not necessarily Um this was not again not necessarily Um this was not again not necessarily new or novel. Other folks had covered new or novel. Other folks had covered new or novel. Other folks had covered this in the news and uh even on the this in the news and uh even on the this in the news and uh even on the Trotocol site itself people were Trotocol site itself people were Trotocol site itself people were complaining in their forums almost all complaining in their forums almost all complaining in their forums almost all the packages that have the T protocol or the packages that have the T protocol or the packages that have the T protocol or garbage. What how is this useful? Um garbage. What how is this useful? Um garbage. What how is this useful? Um but you know this came through our but you know this came through our but you know this came through our assimilation research project and it was assimilation research project and it was assimilation research project and it was you know interesting to dig into. Um so you know interesting to dig into. Um so you know interesting to dig into. Um so lessons learned uh automation is lessons learned uh automation is lessons learned uh automation is necessary to find malware across necessary to find malware across necessary to find malware across ecosystems but it's not sufficient. We ecosystems but it's not sufficient. We ecosystems but it's not sufficient. We still need human eyeballs uh further still need human eyeballs uh further still need human eyeballs uh further tooling further innovation. Um attack tooling further innovation. Um attack tooling further innovation. Um attack techniques involve evolve. Uh so some of techniques involve evolve. Uh so some of techniques involve evolve. Uh so some of the rules that we used you know that the rules that we used you know that the rules that we used you know that used to produce lots of results now are used to produce lots of results now are used to produce lots of results now are producing fewer. Uh we continue to producing fewer. Uh we continue to producing fewer. Uh we continue to iterate on those rules and detection iterate on those rules and detection iterate on those rules and detection techniques. Uh attack techniques are techniques. Uh attack techniques are techniques. Uh attack techniques are common across ecosystems. lots of data common across ecosystems. lots of data common across ecosystems. lots of data exfiltration, lots of droppers, but of exfiltration, lots of droppers, but of exfiltration, lots of droppers, but of course the implementation differs and course the implementation differs and course the implementation differs and attackers will abuse any platform that attackers will abuse any platform that attackers will abuse any platform that allows them to freely automate allows them to freely automate allows them to freely automate money-making schemes, even if it's just money-making schemes, even if it's just money-making schemes, even if it's just for fractions of for fractions of for fractions of pennies. Um, recap, we tal talked about pennies. Um, recap, we tal talked about pennies. Um, recap, we tal talked about OSS malware, why it exists, how to find OSS malware, why it exists, how to find OSS malware, why it exists, how to find it, uh told you about our research it, uh told you about our research it, uh told you about our research project, and shared some of our uh project, and shared some of our uh project, and shared some of our uh results. And since I know many folks results. And since I know many folks results. And since I know many folks here are deeply interested in supply here are deeply interested in supply here are deeply interested in supply chain security, if we have one call to chain security, if we have one call to chain security, if we have one call to action, it's attackers are publishing action, it's attackers are publishing action, it's attackers are publishing more malicious packages every year. more malicious packages every year. more malicious packages every year. Repositories lack the means to identify Repositories lack the means to identify Repositories lack the means to identify all malware. So consider how you're all malware. So consider how you're all malware. So consider how you're securing your organization supply chain securing your organization supply chain securing your organization supply chain against OSS malware. Now I have to, you against OSS malware. Now I have to, you against OSS malware. Now I have to, you know, mention that the folks that own know, mention that the folks that own know, mention that the folks that own and operate the different package and operate the different package and operate the different package managers are constantly evolving and managers are constantly evolving and managers are constantly evolving and doing all they can to reasonably protect doing all they can to reasonably protect doing all they can to reasonably protect users from malware. Um but you know this users from malware. Um but you know this users from malware. Um but you know this is a collaboration with uh everybody who is a collaboration with uh everybody who is a collaboration with uh everybody who uses open source to uh protect against uses open source to uh protect against uses open source to uh protect against the open source malware. Um also would the open source malware. Um also would the open source malware. Um also would like to acknowledge there's been lots of like to acknowledge there's been lots of like to acknowledge there's been lots of prior work on identifying OSS malware prior work on identifying OSS malware prior work on identifying OSS malware both in the open source space. Uh I both in the open source space. Uh I both in the open source space. Uh I don't have time to go through all of don't have time to go through all of don't have time to go through all of these pack all these projects um but these pack all these projects um but these pack all these projects um but wanted to call them out. I'm sure the wanted to call them out. I'm sure the wanted to call them out. I'm sure the slides are available so folks can check slides are available so folks can check slides are available so folks can check them out. And then there has also been a them out. And then there has also been a them out. And then there has also been a large amount of academic work done in large amount of academic work done in large amount of academic work done in this space. Lots of good results in this space. Lots of good results in this space. Lots of good results in these papers. Um check them out if these papers. Um check them out if these papers. Um check them out if you're interested in this you're interested in this you're interested in this area. And that is it. Uh feel free to area. And that is it. Uh feel free to area. And that is it. Uh feel free to reach out to me on LinkedIn. Thank you reach out to me on LinkedIn. Thank you reach out to me on LinkedIn. Thank you everyone. And I'll take any questions everyone. And I'll take any questions everyone. And I'll take any questions with my last two minutes. with my last two minutes. with my last two minutes. Yeah. noticious. Um, so I would consider that more of a Um, so I would consider that more of a Um, so I would consider that more of a derived metadata. derived metadata. derived metadata. Um, Um, Um, so if a if a package is suddenly so if a if a package is suddenly so if a if a package is suddenly downloaded tens of thousands of times downloaded tens of thousands of times downloaded tens of thousands of times within some time frame, you know, like within some time frame, you know, like within some time frame, you know, like since it's publish, then we'd pro then since it's publish, then we'd pro then since it's publish, then we'd pro then we'd that would trigger a further we'd that would trigger a further we'd that would trigger a further review. But just having a a package that review. But just having a a package that review. But just having a a package that is downloaded lots of times isn't is downloaded lots of times isn't is downloaded lots of times isn't necessarily necessarily necessarily interesting, right? Yeah. interesting, right? Yeah. interesting, right? Yeah. Yeah. Yeah. Yeah. Yeah. Yeah. No, no, no. You're you're Yeah. Yeah. No, no, no. You're you're Yeah. Yeah. No, no, no. You're you're you're you're totally fine. Um other you're you're totally fine. Um other you're you're totally fine. Um other questions? Yes. questions? Yes. questions? Yes. The software that Microsoft uh relies on The software that Microsoft uh relies on The software that Microsoft uh relies on like firmware for your for your have you reviewed things like piano your have you reviewed things like piano your have you reviewed things like piano core? Personally, no. And I will also Personally, no. And I will also Personally, no. And I will also uh claim ignorances to tano core and you uh claim ignorances to tano core and you uh claim ignorances to tano core and you know notebook firmware. Um that's know notebook firmware. Um that's know notebook firmware. Um that's outside my area of outside my area of outside my area of expertise. Well just me personally I I expertise. Well just me personally I I expertise. Well just me personally I I not speaking broadly for Microsoft. Uh not speaking broadly for Microsoft. Uh not speaking broadly for Microsoft. Uh what uh so I'm on the open source security uh so I'm on the open source security uh so I'm on the open source security team. Um yeah. Yeah. So lots of distributed domains lots of distributed domains lots of distributed domains firmware firmware security has a firmware firmware security has a firmware firmware security has a completely separate organization. Yeah. Sorry. Yeah. I I I should I should Yeah. Sorry. Yeah. I I I should I should Yeah. Sorry. Yeah. I I I should I should talk about the org structure. Not not talk about the org structure. Not not talk about the org structure. Not not not in specifics, but just like that's not in specifics, but just like that's not in specifics, but just like that's outside. outside. outside. Yeah. All right. Uh and I think one more Yeah. All right. Uh and I think one more Yeah. All right. Uh and I think one more question in the back question in the back question in the back there. So the just repeating for the there. So the just repeating for the there. So the just repeating for the question, why didn't I talk about question, why didn't I talk about question, why didn't I talk about socket? Their whole thing is finding socket? Their whole thing is finding socket? Their whole thing is finding malware and npm packages. Um we're malware and npm packages. Um we're malware and npm packages. Um we're primarily interested in finding packages primarily interested in finding packages primarily interested in finding packages across ecosystems. NPM is definitely across ecosystems. NPM is definitely across ecosystems. NPM is definitely like the biggest target. um appreciate like the biggest target. um appreciate like the biggest target. um appreciate the work that socket does. Um I just the work that socket does. Um I just the work that socket does. Um I just wanted to focus on our work. wanted to focus on our work. wanted to focus on our work. Yeah. All right. Awesome. Thanks Yeah. All right. Awesome. Thanks Yeah. All right. Awesome. Thanks everybody.